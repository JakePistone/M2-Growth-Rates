<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>U.S. M2 Money Supply Growth</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
<style>
:root {
    --bg: #f1f5f9;
    --card: #ffffff;
    --text: #0f172a;
    --muted: #64748b;
    --primary: #2563eb;
    --border: #e5e7eb;
    --future: #dc2626;
}
* { box-sizing: border-box; }
html, body {
    height: 100%;
    margin: 0;
    font-family: 'Inter', system-ui, sans-serif;
    background: var(--bg);
    color: var(--text);
}
.container {
    height: 100%;
    width: 100%;
    padding: 24px 32px;
    display: flex;
    flex-direction: column;
}
header {
    margin-bottom: 14px;
}
header h1 {
    margin: 0 0 4px 0;
    font-size: 26px;
    font-weight: 600;
}
header p {
    margin: 0;
    font-size: 13px;
    color: var(--muted);
}
.card {
    flex: 1;
    background: var(--card);
    border-radius: 14px;
    border: 1px solid var(--border);
    box-shadow: 0 10px 28px rgba(15, 23, 42, 0.05);
    padding: 16px 20px;
    display: flex;
    flex-direction: column;
}
.controls {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 10px;
    flex-wrap: wrap;
}
button {
    height: 36px;
    padding: 0 16px;
    font-size: 13px;
    font-weight: 500;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    background: var(--primary);
    color: #fff;
}
select {
    height: 36px;
    padding: 0 14px;
    font-size: 13px;
    border-radius: 8px;
    border: 1px solid var(--border);
    background: #fff;
    min-width: 160px;
}
label {
    font-size: 12px;
    color: var(--muted);
    white-space: nowrap;
}
.chart-wrapper {
    position: relative;
    flex: 1;
}
footer {
    margin-top: 6px;
    font-size: 11px;
    color: var(--muted);
}
.note {
    font-size: 12px;
    color: var(--muted);
    margin-top: 4px;
}
</style>
</head>
<body>
<div class="container">
<header>
    <h1>U.S. M2 Money Supply Growth</h1>
    <p>Year-over-year growth using December-end levels (1970–2030)</p>
</header>
<div class="card">
    <div class="controls">
        <button id="annualBtn">Annual Growth</button>
        <label for="windowSelect">5-Year Window</label>
        <select id="windowSelect"></select>
    </div>
    <div class="chart-wrapper">
        <canvas id="chart"></canvas>
    </div>
    <footer>
        Historical data: Federal Reserve (FRED) through Dec 2024 · 2025–2030: User-provided projection
    </footer>
    <div class="note">
        Growth rates for 2026–2030 (fully projected) shown in dashed red.
    </div>
</div>
</div>
<script>
// Generate years 1970 to 2030
const years = Array.from({length: 61}, (_, i) => 1970 + i);

// December-end M2 levels (billions)
const m2 = [
626.5,710.3,802.3,855.5,902.1,1016.2,1152.0,1270.3,1366.0,1473.7,
1599.8,1755.5,1905.9,2123.5,2306.4,2492.1,2728.0,2826.4,2988.2,3152.5,
3271.8,3372.2,3424.7,3474.5,3486.4,3629.5,3818.6,4032.9,4375.6,4639.3,
4927.6,5440.5,5779.4,6073.8,6424.5,6687.8,7080.1,7483.9,8204.7,8512.2,
8822.7,9677.1,10474.1,11046.9,11701.0,12368.2,13225.8,13873.5,14382.3,15347.6,
19133.0,21471.0,21219.0,20701.3,21533.8,  // Historical through Dec 2024
22248.80,23848.80,25288.80,26788.80,28348.80,29968.80  // Projected Dec 2025–2030
];

const firstFullyPredictedGrowthYear = 2026;  // Growth from projected to projected

/* Helper to calculate YoY growth */
function calcGrowth(start, end) {
    const labels = [];
    const data = [];
    for (let i = start + 1; i <= end; i++) {
        labels.push(years[i]);
        const growth = (m2[i] / m2[i - 1] - 1) * 100;
        data.push(growth.toFixed(2));
    }
    return { labels, data };
}

/* Chart setup */
const ctx = document.getElementById('chart').getContext('2d');
const chart = new Chart(ctx, {
    type: 'line',
    data: {
        labels: [],
        datasets: [{
            label: '',
            data: [],
            borderWidth: 3,
            tension: 0.35,
            fill: true,
            backgroundColor: 'rgba(37, 99, 235, 0.1)',
            borderColor: '#2563eb',
            pointBackgroundColor: '#2563eb',
            pointRadius: 3,
            pointHoverRadius: 5
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: true } },
        scales: {
            y: { 
                title: { display: true, text: 'Growth Rate (%)' },
                ticks: { callback: value => value + '%' }
            },
            x: { title: { display: true, text: 'Year' } }
        }
    }
});

/* Functions to update chart */
function showAnnual() {
    const r = calcGrowth(0, years.length - 1);
    chart.data.labels = r.labels;
    chart.data.datasets[0].data = r.data;
    chart.data.datasets[0].label = 'Annual YoY M2 Growth (2026–2030 fully projected)';
    chart.data.datasets[0].segment = {
        borderColor: ctx => (ctx.p0.parsed.x >= firstFullyPredictedGrowthYear ? '#dc2626' : '#2563eb'),
        borderDash: ctx => (ctx.p0.parsed.x >= firstFullyPredictedGrowthYear ? [8, 5] : [])
    };
    chart.data.datasets[0].pointBackgroundColor = ctx => (ctx.parsed.x >= firstFullyPredictedGrowthYear ? '#dc2626' : '#2563eb');
    chart.data.datasets[0].pointRadius = ctx => (ctx.parsed.x >= firstFullyPredictedGrowthYear ? 5 : 3);
    chart.update();
}

function showWindow(startIndex) {
    const end = startIndex + 5;
    const r = calcGrowth(startIndex, end);
    chart.data.labels = r.labels;
    chart.data.datasets[0].data = r.data;
    chart.data.datasets[0].label = `M2 Growth (${years[startIndex]}–${years[end]})`;
    delete chart.data.datasets[0].segment;
    delete chart.data.datasets[0].pointRadius;
    chart.data.datasets[0].borderColor = '#2563eb';
    chart.data.datasets[0].pointBackgroundColor = '#2563eb';
    chart.update();
}

/* Controls setup */
const select = document.getElementById('windowSelect');
const annualBtn = document.getElementById('annualBtn');

// Populate dropdown: most recent first (present to past)
for (let i = years.length - 6; i >= 0; i--) {
    const opt = document.createElement('option');
    opt.value = i;
    opt.textContent = `${years[i]}–${years[i + 5]}`;
    select.appendChild(opt);
}

// Default: show Annual Growth on page load
showAnnual();

// Events
annualBtn.addEventListener('click', () => {
    showAnnual();
    select.selectedIndex = -1; // clear selection
});

select.addEventListener('change', (e) => {
    if (e.target.value !== '') {
        showWindow(parseInt(e.target.value, 10));
    } else {
        showAnnual();
    }
});
</script>
</body>
</html>
